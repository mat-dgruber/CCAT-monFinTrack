<div class="p-4 max-w-6xl mx-auto">

  <div class="flex justify-between items-center mb-4">
    <h2 class="text-2xl font-bold text-gray-800">Transações Recentes</h2>
    <p-button
      label="Nova Transação"
      icon="pi pi-plus"
      size="small"
      (onClick)="openNewTransaction()"
    ></p-button>
  </div>

  <div
    class="card bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"
  >
    <p-table [value]="transactions()" [tableStyle]="{ 'min-width': '50rem' }">
      <ng-template pTemplate="header">
        <tr>
          <th>Categoria</th>
          <th>Descrição</th>
          <th>Valor</th>
          <th>Data</th>
          <th>Forma Pagto.</th>
          <th style="width: 5rem"></th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-t>
        <tr>
          <td>
            <div class="flex items-center gap-2">
              <i
                [class]="t.category?.icon"
                [style.color]="t.category?.color"
              ></i>
              <span class="font-medium">{{ t.category?.name }}</span>
            </div>
          </td>

          <td>{{ t.description }}</td>

          <td
            class="font-bold"
            [class.text-red-500]="t.type === 'expense'"
            [class.text-green-500]="t.type === 'income'"
          >
            {{ t.type === "expense" ? "-" : "+" }}
            {{ t.amount | currency : "BRL" }}
          </td>

          <td>{{ t.date | date : "dd/MM/yyyy" }}</td>

          <td class="capitalize">
            {{ t.payment_method | paymentFormat }}
          </td>

          <td class="flex gap-1">
            <p-button
              icon="pi pi-pencil"
              severity="info"
              [text]="true"
              [rounded]="true"
              (onClick)="transactionForm.editTransaction($event, t)"
            >
            </p-button>

            <p-button
              icon="pi pi-trash"
              severity="danger"
              [text]="true"
              [rounded]="true"
              (onClick)="deleteTransaction($event, t)"
            >
            </p-button>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6" class="text-center p-4 text-gray-500">
            Nenhuma transação encontrada.
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <app-transaction-form (save)="loadTransactions()"></app-transaction-form>
</div>
