<div class="p-6 max-w-6xl mx-auto flex flex-col gap-6">
  <div
    class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4"
  >
    <div>
      <h1 class="text-2xl font-bold text-gray-800">
        Assinaturas e Recorrências
      </h1>
      <p class="text-gray-500">
        Gerencie seus pagamentos recorrentes e assinaturas.
      </p>
    </div>

    <div
      class="bg-blue-50 px-4 py-2 rounded-xl border border-blue-100 flex flex-col items-end"
    >
      <span class="text-xs text-blue-600 font-semibold uppercase"
        >Custo Mensal Estimado</span
      >
      <span class="text-xl font-bold text-blue-800">{{
        totalMonthly() | currency : "BRL"
      }}</span>
    </div>
  </div>

  <div
    class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"
  >
    <p-table [value]="recurrences()" [tableStyle]="{ 'min-width': '50rem' }">
      <ng-template pTemplate="header">
        <tr>
          <th>Nome</th>
          <th>Valor</th>
          <th>Periodicidade</th>
          <th>Dia de Vencimento</th>
          <th>Status</th>
          <th>Ações</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-rec>
        <tr>
          <td class="font-medium">{{ rec.name }}</td>
          <td>{{ rec.amount | currency : "BRL" }}</td>
          <td>
            <p-tag [value]="rec.periodicity" severity="info"></p-tag>
          </td>
          <td>Dia {{ rec.due_day }}</td>
          <td>
            <p-tag
              [value]="rec.active ? 'Ativo' : 'Inativo'"
              [severity]="rec.active ? 'success' : 'danger'"
            ></p-tag>
          </td>
          <td>
            <p-button
              icon="pi pi-times"
              [rounded]="true"
              [text]="true"
              severity="danger"
              pTooltip="Cancelar Assinatura"
              (onClick)="cancelRecurrence(rec)"
            >
            </p-button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6" class="text-center py-8 text-gray-500">
            Nenhuma assinatura ativa encontrada.
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>
