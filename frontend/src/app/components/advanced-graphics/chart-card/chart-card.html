<p-card [header]="widget.title">
  <ng-template pTemplate="header">
    <p-toolbar>
      <div class="p-toolbar-group-left">
        <p-selectButton [options]="chartTypeOptions" [(ngModel)]="widget.chartType" (onChange)="onConfigChange()" optionLabel="label" optionValue="value">
          <ng-template let-item>
            <i [class]="item.icon"></i>
            <span>{{item.label}}</span>
          </ng-template>
        </p-selectButton>
      </div>
      <div class="p-toolbar-group-right">
        <div class="flex items-center space-x-2">
          <p-select [options]="periodOptions" [(ngModel)]="widget.dateRange.preset" (onChange)="onConfigChange()"></p-select>
          <p-datepicker [(ngModel)]="widget.dateRange.custom" selectionMode="range" [readonlyInput]="true" (onSelect)="onConfigChange()"></p-datepicker>
          <p-select [options]="groupByOptions" [(ngModel)]="widget.groupBy" (onChange)="onConfigChange()"></p-select>
          <p-selectButton [options]="filterOptions" [(ngModel)]="widget.filter" (onChange)="onConfigChange()" optionLabel="label" optionValue="value"></p-selectButton>
          <p-toggleButton [(ngModel)]="widget.showSummary" onLabel="Hide Summary" offLabel="View Summary" onIcon="pi pi-times" offIcon="pi pi-chart-line"></p-toggleButton>
        </div>
      </div>
    </p-toolbar>
  </ng-template>

  <div class="relative">
    <p-chart [type]="widget.chartType" [data]="data" [options]="options"></p-chart>
    <div *ngIf="widget.showSummary" class="absolute top-0 left-0 w-full h-full bg-white bg-opacity-80 flex items-center justify-center">
      <div class="text-center p-4 rounded-lg bg-gray-100 shadow-lg" *ngIf="summaryData">
        <h4 class="text-lg font-bold">Summary</h4>
        <ul class="text-left mt-2">
          <li>Transactions: {{ summaryData.transactions }}</li>
          <li>Total Value: {{ summaryData.totalValue | currency:'USD':'symbol':'1.2-2' }}</li>
          <li>Average: {{ summaryData.average | currency:'USD':'symbol':'1.2-2' }}</li>
          <li>First Transaction: {{ summaryData.firstTransaction }}</li>
          <li>Last Transaction: {{ summaryData.lastTransaction }}</li>
        </ul>
      </div>
    </div>
  </div>
</p-card>
